var roll=function(){"use strict";var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return(n=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function i(t,e,n,i){return new(n||(n=Promise))((function(s,o){function r(t){try{a(i.next(t))}catch(t){o(t)}}function u(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,u)}a((i=i.apply(t,e||[])).next())}))}function s(t,e){var n,i,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=2&o[0]?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=r.trys,(s=s.length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],i=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var o,r="https://declarativebulletapi.com",u=function(){function t(){this.fromV="",this.intoV=""}return t.prototype.from=function(t){return this.fromV=t,this},t.prototype.into=function(t){return this.intoV=t,this},t}(),a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.asJson=function(){if(this.fieldsV)return this.fieldsV;var t={};return this.keyV&&(t.key=this.keyV),this.selectList.forEach((function(e){return t[e.intoV]=e.fromV})),Object.keys(t)?t:null},n}(function(){function t(){this.selectList=[],this.fieldsV="",this.keyV=""}return t.prototype.addFromInto=function(t){var e=new u;return t(e),this.selectList.push(e),this},t.prototype.fields=function(t){return this.fieldsV=t,this},t.prototype.key=function(t){return this.keyV=t,this},t}()),h=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.asJson=function(){var t={};return t.route=this.routeV,t.select=this.selectV,t.send=this.sendV,t},n}(function(){function t(){this.routeV="",this.selectV="",this.sendV={},this.takeObjValue=null}return t.prototype.route=function(t){return this.routeV=t,this},t.prototype.pick=function(t){return this.selectV=t,this},t.prototype.take=function(t){this.takeObjValue||(this.takeObjValue={});var e=new a;t(e);var n=e.asJson();return n&&(this.takeObjValue.select=n),this},t}());!function(t){t[t.FreeSlot=0]="FreeSlot",t[t.AddedFile=1]="AddedFile",t[t.ExistentFile=2]="ExistentFile",t[t.DeletedFile=3]="DeletedFile",t[t.ReplacedFile=4]="ReplacedFile"}(o||(o={}));var l,c,p,f=function(){function t(t){if(void 0===t&&(t=null),this.fileContent=null,this.serverPath="",this.fileUrl="",this.status=o.FreeSlot,this.changed=!1,this.accept="*.*",t){var e=t.guid,n=t.fileContent,i=t.filePath;this.guid=e,this.serverPath=i,this.fileContent=n,this.fileUrl="/"+i,this.status=o.ExistentFile}}return t.prototype.setFileContent=function(t){this.fileContent=t,this.status!==o.ExistentFile?this.status=o.AddedFile:this.status=o.ReplacedFile},t.prototype.markForDeletion=function(){this.fileContent=null,this.status===o.ExistentFile&&(this.status=o.DeletedFile),this.status=o.FreeSlot},t.prototype.addFileToForm=function(t){var e=this.fileContent,n=this.status,i=this.guid;return!!e&&((n===o.AddedFile||n===o.ReplacedFile)&&(t.append(i,e,e.name),!0))},t.prototype.shouldBeSaved=function(){return this.status===o.AddedFile||this.status===o.ReplacedFile},t}(),d=function(){function t(){this.files=[]}return t.prototype.loadFilesFromAJsonList=function(t){var e=[],n=null;t.forEach((function(t){n=new f(t),e.push(n)})),this.files=e},t.prototype.addFileFromAnObject=function(t){this.files||(this.files=[]);var e=new f(t);this.files.push(e)},t.prototype.addIFile=function(t){new f(t),this.files||(this.files=[]),this.files.push(t)},t.prototype.createNewSlot=function(){this.files.push(new f({}))},t.prototype.forEach=function(t){this.files.forEach((function(e){return t(e)}))},t}();!function(t){t.INSERT="insert",t.UPDATE="update",t.UPDATE_ONE="updateOne",t.DELETE="delete",t.DELETE_ONE="deleteOne",t.FIND="find",t.FIND_ONE="findOne",t.PAGINATION="page"}(l||(l={})),function(t){t.FIND="find",t.FIND_ONE="findOne",t.PAGINATION="page"}(c||(c={})),function(t){t.GOOGLE="google",t.LOCAL="local"}(p||(p={}));var y=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.asJson=function(){var t={};return t.bucket=this.directoryV,t.provider=this.providerV,t},n}(function(){function t(){this.directoryV="",this.providerV=p.GOOGLE}return t.prototype.bucket=function(t){return this.directoryV=t,this},t.prototype.provider=function(t){return this.providerV=t,this},t.prototype.addFile=function(t){return this.files||(this.files=new d),this.files.addIFile(t),this},t.prototype.addFiles=function(t){var e=this;return this.files||(this.files=new d),t.forEach((function(t){e.files.addIFile(t)})),this},t}()),v=function(t){this.success=!1,this.data=null,this.message="",this.success=t.success,this.data=t.data,this.message=t.message},V=function(){this.deletedFiles=null,this.replacedFiles=null},g=function(){function t(t){t.serverUrl||(t.serverUrl=r),this.bulletAuthentication=t}return t.prototype.sendBulletApiRequest=function(t){var e=this.bulletAuthentication.serverUrl+"/api/private/bullet/v1";return this.axiosPost(e,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.createUser=function(t,e){void 0===e&&(e="v1");var n=this.bulletAuthentication.serverUrl+"/api/user/"+e+"/createUser";return this.axiosPost(n,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.createUserAndLogin=function(t,e){void 0===e&&(e="v1");var n=this.bulletAuthentication.serverUrl+"/api/user/"+e+"/createUserAndLogin";return this.axiosPost(n,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.forgotPassword=function(t,e){void 0===e&&(e="v1");var n=this.bulletAuthentication.serverUrl+"/api/user/"+e+"/forgotPassword";return this.axiosPost(n,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.resetPassword=function(t,e){void 0===e&&(e="v1");var n=this.bulletAuthentication.serverUrl+"/api/user/"+e+"/resetpassword";return this.axiosPost(n,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.login=function(t,e){void 0===e&&(e="v1");var n=this.bulletAuthentication.serverUrl+"/api/user/"+e+"/login";return this.axiosPost(n,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.changePassword=function(t,e){void 0===e&&(e="v1");var n=this.bulletAuthentication.serverUrl+"/api/logged-user/"+e+"/changePassword";return this.axiosPost(n,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.delete=function(t){void 0===t&&(t="v1");var e=this.bulletAuthentication.serverUrl+"/api/logged-user/"+t+"/delete";return this.axiosPost(e,{}).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.confirmUser=function(t,e){void 0===e&&(e="v1");var n=this.bulletAuthentication.serverUrl+"/api/user/"+e+"/confirm";return this.axiosPost(n,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.sendApiRequest=function(t){var e=this.bulletAuthentication.serverUrl;return this.axiosPost(e,t).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.resolve({data:null,success:!1,message:t})}))},t.prototype.saveFiles=function(t,e,n){var i=this.bulletAuthentication.serverUrl,s=new FormData;e.forEach((function(t){t.addFileToForm(s)}));var r=[];e.filter((function(t){return t.status===o.DeletedFile})).forEach((function(t){return r.push({guid:t.guid,filePath:t.serverPath})}));var u=[];e.filter((function(t){return t.status===o.ReplacedFile})).forEach((function(t){return u.push({guid:t.guid,filePath:t.serverPath})}));var a=new V;return a.deletedFiles=r,a.replacedFiles=u,a.provider=n,s.append("data",JSON.stringify({body:t,fileOptions:a})),this.axiosPost(i,s)},t.prototype.axiosPost=function(t,e){return i(this,void 0,Promise,(function(){var n,i,o,r;return s(this,(function(s){switch(s.label){case 0:n={headers:this.createHeader()},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,axios.post(t,e,n)];case 2:return i=s.sent(),[2,new v(i.data)];case 3:return o=s.sent(),r={},o.response?(r.data=o.response.data.data,r.status=o.response.status):o.request?r.request=o.request:r.message=o.message,[2,new v({error:1,message:r})];case 4:return[2]}}))}))},t.prototype.createHeader=function(){return{"Content-Type":"application/json;charset=UTF-8",Authorization:this.bulletAuthentication.authentication}},t}(),w=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.asJson=function(){var t={};return this.findV&&(t=this.findV),this.regexV&&(t.regex=this.regexV),this.expressionV&&(t.expression=this.expressionV),t},n.prototype.regexValue=function(){return this.regexV},n.prototype.expressionValue=function(){return this.expressionV},n.prototype.findObjectValue=function(){return this.findV},n}(function(){function t(){this.regexV=null,this.expressionV="",this.findV=null}return t.prototype.regex=function(t){if("string"==typeof t)throw new Error('plase provide an object for the regex. e.g. {name: "^clau" }');return this.regexV=t,this},t.prototype.expression=function(t){return this.expressionV=t,this},t.prototype.findByObject=function(t){return this.findV=t,this},t}()),b=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.asJson=function(){var t={};return t.itemsOnPage=this.itemsOnPageV,t.pageNo=this.pageNoV,t},n}(function(){function t(){this.itemsOnPageV=5,this.pageNoV=1}return t.prototype.itemsOnPage=function(t){return this.itemsOnPageV=t,this},t.prototype.pageNo=function(t){return this.pageNoV=t,this},t}()),m=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.asJson=function(){return{collection:this.collectionV,field:this.fieldV,method:this.methodV,owned:this.ownedV}},n}(function(){function t(){this.collectionV="",this.fieldV="",this.methodV=c.FIND,this.ownedV=!1,this.pageInstance=null}return t.prototype.collection=function(t){return this.collectionV=t,this},t.prototype.field=function(t){return this.fieldV=t,this},t.prototype.method=function(t){return this.methodV=t,this},t.prototype.owned=function(t){return this.ownedV=t,this},t.prototype.page=function(t){var e=new b;return t(e),this.pageInstance=e,this},t}()),P=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),Object.defineProperty(n.prototype,"fieldValue",{get:function(){return this.fieldV},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ascendingValue",{get:function(){return this.ascendingV},enumerable:!1,configurable:!0}),n}(function(){function t(){this.fieldV="",this.ascendingV=!0}return t.prototype.field=function(t){return this.fieldV=t,this},t.prototype.ascending=function(t){return this.ascendingV=t,this},t}()),F=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.buildtake=function(){var t={};return Object.keys(t)?t:null},n.prototype.includeSort=function(){if(!this.sortList||!this.sortList.length)return null;var t={};return this.sortList.forEach((function(e){return t[e.fieldValue]=e.ascendingValue?1:-1})),t},n.prototype.includePage=function(){return this.pageInstance?this.pageInstance.asJson():null},n.prototype.asJson=function(){if(!this.joinInstance||!this.fieldV)return null;var t={};t.field=this.fieldV,this.keyV&&(t.key=this.keyV);var e=this.joinInstance.asJson();e&&(t.with=e);var n=this.wrapperTake.asJson();n&&(t.take=n);var i=this.includeSort();i&&(t.sort=i);var s=this.includePage();if(s&&(t.pager=s),this.joinList&&this.joinList.length){var o=[],r=null;this.joinList.forEach((function(t){r=t.asJson(),o.push(r)})),t.join=o}return t},n}(function(){function t(){this.fieldV="",this.keyV="",this.selectObjValue=null,this.wrapperTake=null,this.sortList=null,this.pageInstance=null,this.joinList=null}return t.prototype.field=function(t){return this.fieldV=t,this},t.prototype.key=function(t){return this.keyV=t,this},t.prototype.with=function(t){var e=new m;return t(e),this.joinInstance=e,this},t.prototype.take=function(t){var e=new a;return t(e),this.wrapperTake=e,this},t.prototype.sort=function(t){this.sortList||(this.sortList=[]);var e=new P;return t(e),this.sortList.push(e),this},t.prototype.page=function(t){var e=new b;return t(e),this.pageInstance=e,this},t.prototype.join=function(t){this.joinList||(this.joinList=[]);var e=new F;return t(e),this.joinList.push(e),this},t}()),j=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.asJson=function(){if(!this.errorcodeV)return null;var t={};return t.condition=this.conditionV,t.errorcode=this.errorcodeV,t},n}(function(){function t(){this.conditionV="",this.errorcodeV=""}return t.prototype.condition=function(t){return this.conditionV=t,this},t.prototype.errorcode=function(t){return this.errorcodeV=t,this},t}()),L=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.asJson=function(){var t=n({},this.data);if(this.executeIf&&(t.condition=this.executeIf.asJson()),this.selectObjValue&&(t.take=this.selectObjValue),this.findInstance&&(t.find=this.findInstance.asJson()),this.keyValue&&(t.key=this.keyValue),this.joinList&&this.joinList.length){var e=[],i=null;this.joinList.forEach((function(t){i=t.asJson(),e.push(i)})),t.join=e}var s=this.includePage();s&&(t.page=s);var o=this.includeSort();return o&&(t.sort=o),this.flowInstance&&(t.flow=this.flowInstance.asJson()),t},i.prototype.includePage=function(){return this.pageInstance?this.pageInstance.asJson():null},i.prototype.includeSort=function(){if(!this.sortList||!this.sortList.length)return null;var t={};return this.sortList.forEach((function(e){return t[e.fieldValue]=e.ascendingValue?1:-1})),t},i}(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.flow=function(t){var e=new L;return t(e),this.flowInstance=e,this},n}(function(){function t(){this.data={},this.keyValue="",this.bodyFields=[],this.selectObjValue=null,this.joinList=null,this.pageInstance=null,this.sortList=null,this.findInstance=null}return t.prototype.insert=function(t){return this.setCollection(t),this.setMethod(l.INSERT),this},t.prototype.method=function(t){return this.setMethod(t),this},t.prototype.updateCollection=function(t){return this.setCollection(t),this.setMethod(l.UPDATE),this},t.prototype.deleteFromCollection=function(t){return this.setCollection(t),this.setMethod(l.DELETE),this},t.prototype.searchIntoCollection=function(t){return this.setCollection(t),this.setMethod(l.FIND),this},t.prototype.paginateCollection=function(t){return this.setCollection(t),this.setMethod(l.PAGINATION),this},t.prototype.collection=function(t){return this.setCollection(t),this},t.prototype.key=function(t){return this.keyValue=t,this},t.prototype.storage=function(t){var e=new y;return t(e),this.data.storage=e.asJson(),this},t.prototype.flow=function(t){var e=new L;return t(e),this.flowInstance=e,this},t.prototype.setCollection=function(t){t&&(this.data.info=this.data.info||{},this.data.info.collection=t)},t.prototype.setMethod=function(t){this.data.info=this.data.info||{},this.data.info.method=t},t.prototype.body=function(t){return void 0===t&&(t={}),this.data.body=t,this},t.prototype.bodyField=function(t,e){var n=new h;return e(n),this.bodyFields.push(n),this.data.bodyFields=this.data.bodyFields||{},this.data.bodyFields[t]=n.asJson(),this},t.prototype.take=function(t){this.selectObjValue||(this.selectObjValue={});var e=new a;t(e);var n=e.asJson();return n&&(this.data.select=n),this},t.prototype.join=function(t){this.joinList||(this.joinList=[]);var e=new F;return t(e),this.joinList.push(e),this},t.prototype.page=function(t){var e=new b;return t(e),this.pageInstance=e,this},t.prototype.sort=function(t){this.sortList||(this.sortList=[]);var e=new P;return t(e),this.sortList.push(e),this},t.prototype.find=function(t){var e=new w;return t(e),this.findInstance=e,this},t.prototype.condition=function(t){var e=new j;return t(e),this.executeIf=e,this},t}())),I=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.asJson=function(){var t={};return this.nameV&&(t.name=this.nameV),this.methodV&&(t.method=this.methodV),this.ownedV&&(t.owned=this.ownedV),t},n}(function(){function t(){this.nameV="",this.ownedV=!1,this.methodV=""}return t.prototype.name=function(t){return this.nameV=t,this},t.prototype.owned=function(t){return this.ownedV=t,this},t.prototype.method=function(t){return this.methodV=t,this},t}());return function(){function t(t){this.data={},this.keyValue="",this.bodyFields=[],this.selectObjValue=null,this.joinList=null,this.pageInstance=null,this.sortList=null,this.findInstance=null,t.serverUrl||(t.serverUrl=r),this.bulletAuthentication=t}return t.prototype.collection=function(t){var e=new I;return t(e),this._collection=e,this},t.prototype.key=function(t){return this.keyValue=t,this},t.prototype.storage=function(t){var e=new y;return t(e),this.data.storage=e.asJson(),this},t.prototype.flow=function(t){var e=new L;return t(e),this.flowInstance=e,this},t.prototype.body=function(t){return void 0===t&&(t={}),this.data.body=t,this},t.prototype.bodyField=function(t,e){var n=new h;return e(n),this.bodyFields.push(n),this.data.bodyFields=this.data.bodyFields||{},this.data.bodyFields[t]=n.asJson(),this},t.prototype.take=function(t){this.selectObjValue||(this.selectObjValue={});var e=new a;t(e);var n=e.asJson();return n&&(this.data.select=n),this},t.prototype.join=function(t){this.joinList||(this.joinList=[]);var e=new F;return t(e),this.joinList.push(e),this},t.prototype.page=function(t){var e=new b;return t(e),this.pageInstance=e,this},t.prototype.sort=function(t){this.sortList||(this.sortList=[]);var e=new P;return t(e),this.sortList.push(e),this},t.prototype.find=function(t){var e=new w;return t(e),this.findInstance=e,this},t.prototype.includePage=function(){return this.pageInstance?this.pageInstance.asJson():null},t.prototype.includeSort=function(){if(!this.sortList||!this.sortList.length)return null;var t={};return this.sortList.forEach((function(e){return t[e.fieldValue]=e.ascendingValue?1:-1})),t},t.prototype.asJson=function(){var t=n({},this.data);if(!this._collection)throw new Error("please set the collection information");if(t.collection=this._collection.asJson(),this.selectObjValue&&(t.take=this.selectObjValue),this.findInstance&&(t.find=this.findInstance.asJson()),this.keyValue&&(t.key=this.keyValue),this.joinList&&this.joinList.length){var e=[],i=null;this.joinList.forEach((function(t){i=t.asJson(),e.push(i)})),t.join=e}var s=this.includePage();s&&(t.page=s);var o=this.includeSort();return o&&(t.sort=o),this.flowInstance&&(t.flow=this.flowInstance.asJson()),t},t.prototype.execute=function(){var t=this.asJson();return new g(this.bulletAuthentication).sendBulletApiRequest(t)},t}()}();
